(this["webpackJsonpgp-tracker"]=this["webpackJsonpgp-tracker"]||[]).push([[0],{32:function(e,t,n){e.exports=n(55)},37:function(e,t,n){},52:function(e,t,n){},55:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(26),i=n.n(a),l=(n(37),n(20)),c=n.n(l),s=n(27),u=n(7),p=n(21),d=(n(39),n(9)),m=n(31),f=n(5),h=(n(52),n(11)),v=n(6),y=n(12);function g(){var e=Object(h.a)(["\n  cursor: pointer;\n  flex: 1;\n  padding: 0 5px;\n  border-radius: 2px;\n  color: ",";\n  :hover {\n    background-color: rgba(0, 0, 0, 0.3);\n  }\n"]);return g=function(){return e},e}function b(){var e=Object(h.a)(["\n  background-color: ",";\n  height: 12px;\n  border-radius: 50%;\n  -moz-border-radius: 50%;\n  -webkit-border-radius: 50%;\n  width: 12px;\n  position: absolute;\n  left: 50%;\n  top: ",";\n  transform: ",";\n"]);return b=function(){return e},e}function x(){var e=Object(h.a)(["\n  width: 4px;\n  background-color: ",";\n  align-self: stretch;\n  padding: 0;\n  margin: 0 5px 0 10px;\n  position: relative;\n"]);return x=function(){return e},e}var w=y.a.div(x(),(function(e){return e.isStationPassed?"white":"grey"})),S=y.a.div(b(),(function(e){return e.isStationPassed?"#fff":"grey"}),(function(e){var t=e.isFirstStation,n=e.isLastStation;return t?"0":n?"100%":"50%"}),(function(e){return e.isFirstStation?"translate(-50%,0)":"translate(-50%, -50%)"})),E=y.a.div(g(),(function(e){return e.isNotStation?"grey":"white"})),j=function(e){var t=e.map,n=e.station,r=e.isStationPassed,a=e.isNotStation,i=e.isFirstStation,l=e.isLastStation,c="center",s="5px 0";return i?(c="flex-start",s="0 0 5px 0"):l&&(c="flex-end",s="5px 0 0 0"),o.a.createElement("div",{style:{display:"flex",alignItems:c,justifyContent:"flex-start"}},o.a.createElement("div",{style:{width:"60px",padding:s}},i||a?null:o.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",flexWrap:"nowrap"}},r?null:o.a.createElement("span",{style:{marginRight:"5px",color:Object(v.b)(n.arrivalDelay)}},n.arrivalDelay?"+".concat(Object(d.b)(n.arrivalDelay)):"+0"),o.a.createElement("span",null,Object(d.c)(n.arrivalTime))),l||a?null:o.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",flexWrap:"nowrap"}},r?null:o.a.createElement("span",{style:{marginRight:"5px",color:Object(v.b)(n.arrivalDelay)}},n.departureDelay&&r?"+".concat(Object(d.b)(n.departureDelay)):"+0"),o.a.createElement("span",null,Object(d.c)(n.departureTime)))),o.a.createElement(w,{isStationPassed:r},o.a.createElement(S,{isFirstStation:i,isLastStation:l,isStationPassed:r})),o.a.createElement(E,{isNotStation:a,onClick:function(){t.flyTo({center:n.coordinates,essential:!0})}},n.stationName))};function k(){var e=Object(h.a)(["\n  left: 10px;\n  top: 14px;\n  position: absolute;\n  cursor: pointer;\n  display: inline-block;\n  border-right: 4px solid white;\n  border-bottom: 4px solid white;\n  opacity: 0.4;\n  width: 10px;\n  height: 10px;\n  &:hover {\n    opacity: 1;\n  }\n  &.hideChevron {\n    transform: rotate(-225deg);\n  }\n  &.expandChevron {\n    transform: rotate(-45deg);\n  }\n"]);return k=function(){return e},e}function O(){var e=Object(h.a)(["\n  position: absolute;\n  right: 5px;\n  top: 10px;\n  width: 32px;\n  height: 32px;\n  opacity: 0.4;\n  cursor: pointer;\n  &:hover {\n    opacity: 1;\n  }\n  &:before,\n  &:after {\n    position: absolute;\n    left: 15px;\n    content: ' ';\n    height: 20px;\n    width: 2px;\n    background-color: white;\n  }\n  &:before {\n    transform: rotate(45deg);\n  }\n  &:after {\n    transform: rotate(-45deg);\n  }\n"]);return O=function(){return e},e}function L(){var e=Object(h.a)(["\n  border-radius: 50%;\n  width: 40px;\n  min-width: 40px;\n  height: 40px;\n  border: solid black 2px;\n  display: inline-flex;\n  margin: 10px 15px 10px 0;\n  justify-content: center;\n  align-items: center;\n  font-weight: bold;\n"]);return L=function(){return e},e}function P(){var e=Object(h.a)(["\n  position: absolute;\n  height: 100%;\n  width: ",";\n  transform: ",";\n  padding: ",";\n  overflow: auto;\n  overflow-x: hidden;\n  top: auto;\n  right: auto;\n  left: 0;\n  background-color: rgba(0, 0, 0, 0.6);\n  z-index: 1000;\n  color: white;\n  transition: width 0.2s ease-in-out;\n"]);return P=function(){return e},e}function C(){var e=Object(h.a)(["\n  opacity: 0;\n  animation-name: ",";\n  animation-timing-function: ease;\n  animation-fill-mode: forwards;\n  animation-delay: 0.2s;\n  animation-duration: 1s;\n"]);return C=function(){return e},e}function T(){var e=Object(h.a)(["\nfrom{\n  opacity: 0;\n}\nto{\n  opacity: 1;\n}\n"]);return T=function(){return e},e}var N=Object(y.b)(T()),D=y.a.div(C(),N),I=y.a.div(P(),(function(e){return e.modalWidth}),(function(e){return e.translateStyle}),(function(e){return"0"!==e.modalWidth?"30px 20px 20px 20px":""})),W=y.a.span(L()),F=y.a.span(O()),R=y.a.div(k()),z=function(e){return!e.arrivalTime&&!e.departureTime},G=function(e,t){var n=e.departureTime||e.arrivalTime||0,r=e.departureDelay||e.arrivalDelay||0;return!z(e)&&n+r<=t},B=function(e){var t,n=e.map,a=e.vehicle,i=e.trackerLayer,l=e.setSelectedVehicle,c=Object(r.useState)(!1),s=Object(u.a)(c,2),p=s[0],d=s[1];t=a?p?"40px":"350px":"0";return o.a.createElement(I,{modalWidth:t},"0"!==t?o.a.createElement(R,{className:p?"expandChevron":"hideChevron",onClick:function(){return d((function(e){return!e}))}}):null,"350px"===t?o.a.createElement(D,null,o.a.createElement(F,{onClick:function(){l(null),i.selectedVehicleId=null,i.map.getSource("routeLines")&&(i.map.removeLayer("routeLines"),i.map.removeSource("routeLines")),i.map.getSource("routePoints")&&(i.map.removeLayer("routePoints"),i.map.removeSource("routePoints"))}}),o.a.createElement("div",{style:{display:"flex"}},o.a.createElement(W,{style:{backgroundColor:(null===a||void 0===a?void 0:a.backgroundColor)?null===a||void 0===a?void 0:a.backgroundColor:"white",color:(null===a||void 0===a?void 0:a.color)?null===a||void 0===a?void 0:a.color:"black"}},a.shortName),o.a.createElement("div",null,o.a.createElement("div",{style:{fontWeight:"bold"}},a.longName),o.a.createElement("div",{style:{fontSize:"14px"}},o.a.createElement("div",null,a.shortName),o.a.createElement("div",null,v.h[a.vehicleType]),o.a.createElement("div",null,"Operator: ",a.operator)))),o.a.createElement("div",{style:{marginTop:"20px"}},a.stations.map((function(e,t){return o.a.createElement(j,{map:n,key:e.stationId,station:e,isStationPassed:G(e,i.currTime),isNotStation:z(e),isFirstStation:0===t,isLastStation:t===a.stations.length-1})})))):null)},M=function(){var e=Object(r.useState)(null),t=Object(u.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)(null),l=Object(u.a)(i,2),h=l[0],v=l[1],y=Object(r.useState)(null),g=Object(u.a)(y,2),b=g[0],x=g[1],w=Object(r.useRef)(b),S=function(e){w.current=e,x(e)};return Object(r.useEffect)((function(){var e;(function(){var t=Object(s.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://developer.geops.io/publickey").then((function(e){return e.json()})).then((function(t){e=t.key}));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()().then((function(){var t=new p.Map({container:"map",style:"https://maps.geops.io/styles/travic/style.json?key=".concat(e),center:[21,52.25],zoom:8});t.addControl(new p.NavigationControl({showCompass:!1}),"bottom-right"),t.dragRotate.disable(),t.touchZoomRotate.disableRotation();var n=new m.a({url:"https://api.geops.io/tracker/v1",apiKey:e});n.onClick((function(e){var t;e?(null===w||void 0===w||null===(t=w.current)||void 0===t?void 0:t.id)!==(null===e||void 0===e?void 0:e.id)&&(S(e),n.highlightTrajectory=function(){n.api.fetchTrajectoryById(n.getParams({id:n.journeyId,time:Object(d.d)(n.currTime)})).then((function(t){var r=t.p,o=[];r.forEach((function(e){e.forEach((function(e){o.push(Object(f.f)([e.x,e.y],"EPSG:3857","EPSG:4326"))}))})),n.map.getSource("routeLines")&&(n.map.removeLayer("routeLines"),n.map.removeSource("routeLines")),n.map.getSource("routePoints")&&(n.map.removeLayer("routePoints"),n.map.removeSource("routePoints"));var a=n.stationsCoords.map((function(e){return Object(f.f)([e[0],e[1]],"EPSG:3857","EPSG:4326")}));a&&(n.map.addSource("routePoints",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"MultiPoint",coordinates:a}}}),n.map.addLayer({id:"routePoints",type:"circle",source:"routePoints",paint:{"circle-radius":6,"circle-color":e.backgroundColor?e.backgroundColor:"#888"}},n.key)),o&&(n.map.addSource("routeLines",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:o}}}),n.map.addLayer({id:"routeLines",type:"line",source:"routeLines",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":e.backgroundColor?e.backgroundColor:"#888","line-width":5}},"routePoints"))})).catch((function(){}))},n.highlightTrajectory()):(S(null),n.map.getSource("routeLines")&&(n.map.removeLayer("routeLines"),n.map.removeSource("routeLines")),n.map.getSource("routePoints")&&(n.map.removeLayer("routePoints"),n.map.removeSource("routePoints")))})),a(n),t.on("load",(function(){n.init(t,"waterway-name")})),v(t)}))}),[]),o.a.createElement("div",null,o.a.createElement("div",{style:{display:"flex",height:"100vh",width:"100vw",position:"relative"}},o.a.createElement(B,{map:h,trackerLayer:n,vehicle:b,setSelectedVehicle:S}),o.a.createElement("div",{id:"map",style:{flex:1},tabIndex:0})),o.a.createElement("div",{style:{position:"absolute",top:"10px",right:"10px",display:"block",width:"300px",zIndex:1e3}},o.a.createElement("a",{href:"./assets/system_transportowy.pdf",target:"_blank",rel:"noopener noreferrer"},o.a.createElement("img",{style:{height:"66px"},src:"./assets/logo2.png",alt:""})),o.a.createElement("a",{href:"https://www.gispartner.pl/",target:"_blank",rel:"noopener noreferrer"},o.a.createElement("img",{style:{height:"50px"},src:"./assets/logo1.png",alt:""}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[32,1,2]]]);
//# sourceMappingURL=main.6f8fab37.chunk.js.map